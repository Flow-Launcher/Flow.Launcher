<UserControl
    x:Class="Flow.Launcher.Plugin.Explorer.Views.ExplorerSettings"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:Flow.Launcher.Plugin.Explorer.Views.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:qa="clr-namespace:Flow.Launcher.Plugin.Explorer.Search.QuickAccessLinks"
    xmlns:ui="http://schemas.inkore.net/lib/ui/wpf/modern"
    xmlns:viewModels="clr-namespace:Flow.Launcher.Plugin.Explorer.ViewModels"
    d:DataContext="{d:DesignInstance viewModels:SettingsViewModel}"
    d:DesignHeight="450"
    d:DesignWidth="800"
    mc:Ignorable="d">

    <UserControl.Resources>
        <DataTemplate x:Key="ListViewTemplateAccessLinks" DataType="qa:AccessLink">
            <TextBlock Margin="0 5 0 5" Text="{Binding Path, Mode=OneTime}" />
        </DataTemplate>
        <DataTemplate x:Key="ListViewActionKeywords" DataType="{x:Type viewModels:ActionKeywordModel}">
            <Grid>
                <TextBlock
                    Margin="0 5 0 0"
                    IsEnabled="{Binding Enabled}"
                    Text="{Binding LocalizedDescription, Mode=OneTime}">
                    <TextBlock.Style>
                        <Style TargetType="{x:Type TextBlock}">
                            <Style.Triggers>
                                <Trigger Property="IsEnabled" Value="True">
                                    <Setter Property="Foreground" Value="{DynamicResource Color05B}" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter Property="Foreground" Value="{DynamicResource Color18B}" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>

                <TextBlock
                    Margin="250 5 0 0"
                    IsEnabled="{Binding Enabled}"
                    Text="{Binding Keyword}">
                    <TextBlock.Style>
                        <Style TargetType="{x:Type TextBlock}">
                            <Style.Triggers>
                                <Trigger Property="IsEnabled" Value="True">
                                    <Setter Property="Foreground" Value="{DynamicResource Color05B}" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter Property="Foreground" Value="{DynamicResource Color18B}" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>

                <TextBlock Margin="480 5 0 0">
                    <TextBlock.Style>
                        <Style TargetType="{x:Type TextBlock}">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Enabled}" Value="True">
                                    <Setter Property="Text" Value="{DynamicResource plugin_explorer_enabled}" />
                                    <Setter Property="Foreground" Value="{DynamicResource Color05B}" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Enabled}" Value="False">
                                    <Setter Property="Text" Value="{DynamicResource plugin_explorer_disabled}" />
                                    <Setter Property="Foreground" Value="{DynamicResource Color18B}" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>
            </Grid>
        </DataTemplate>

        <converters:EnumNameConverter x:Key="EnumNameConverter" />

        <Style x:Key="CustomExpanderStyle" TargetType="Expander">
            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
            <Setter Property="VerticalContentAlignment" Value="Stretch" />
            <Setter Property="BorderBrush" Value="{DynamicResource Color03B}" />
            <Setter Property="Foreground" Value="{DynamicResource Color05B}" />
            <Setter Property="BorderThickness" Value="0 0 0 1" />
            <Setter Property="Padding" Value="-8 18 24 14" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Expander">
                        <Border
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            SnapsToDevicePixels="true">
                            <DockPanel>
                                <ToggleButton
                                    x:Name="HeaderSite"
                                    MinWidth="0"
                                    MinHeight="0"
                                    Margin="0"
                                    Padding="{TemplateBinding Padding}"
                                    HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
                                    Content="{TemplateBinding Header}"
                                    ContentTemplate="{TemplateBinding HeaderTemplate}"
                                    ContentTemplateSelector="{TemplateBinding HeaderTemplateSelector}"
                                    DockPanel.Dock="Top"
                                    FocusVisualStyle="{StaticResource ExpanderHeaderFocusVisual}"
                                    FontFamily="{TemplateBinding FontFamily}"
                                    FontSize="{TemplateBinding FontSize}"
                                    FontStretch="{TemplateBinding FontStretch}"
                                    FontStyle="{TemplateBinding FontStyle}"
                                    FontWeight="{TemplateBinding FontWeight}"
                                    Foreground="{TemplateBinding Foreground}"
                                    IsChecked="{Binding IsExpanded, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                    Style="{StaticResource ExpanderHeaderRightArrowStyle}" />
                                <Border
                                    x:Name="ContentPresenterBorder"
                                    BorderBrush="{DynamicResource Color03B}"
                                    BorderThickness="0 1 0 0">
                                    <ContentPresenter
                                        x:Name="ExpandSite"
                                        Margin="{TemplateBinding Padding}"
                                        HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                        VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                        DockPanel.Dock="Bottom"
                                        Focusable="false" />
                                    <Border.LayoutTransform>
                                        <ScaleTransform ScaleY="0" />
                                    </Border.LayoutTransform>
                                </Border>
                            </DockPanel>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsExpanded" Value="true">
                                <Setter TargetName="ExpandSite" Property="Visibility" Value="Visible" />
                                <Setter TargetName="ContentPresenterBorder" Property="BorderThickness" Value="0 1 0 0" />
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation
                                                Storyboard.TargetName="ContentPresenterBorder"
                                                Storyboard.TargetProperty="(Border.LayoutTransform).(ScaleTransform.ScaleY)"
                                                From="0.0"
                                                To="1.0"
                                                Duration="0:0:0" />
                                            <DoubleAnimation
                                                Storyboard.TargetName="ContentPresenterBorder"
                                                Storyboard.TargetProperty="(Border.Opacity)"
                                                From="0.0"
                                                To="1.0"
                                                Duration="0:0:0" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation
                                                Storyboard.TargetName="ContentPresenterBorder"
                                                Storyboard.TargetProperty="(Border.LayoutTransform).(ScaleTransform.ScaleY)"
                                                From="1.0"
                                                To="0.0"
                                                Duration="0:0:0" />
                                            <DoubleAnimation
                                                Storyboard.TargetName="ContentPresenterBorder"
                                                Storyboard.TargetProperty="(Border.Opacity)"
                                                From="1.0"
                                                To="0.0"
                                                Duration="0:0:0" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>

    <!--  Margin="-2 0 -2 0" is to make sure separator between expanders are expanded to left & right boarder  -->
    <StackPanel x:Name="ExpanderContainer" Margin="-2 0 -2 0">
        <!--  General Settings Expander  -->
        <Expander
            x:Name="GeneralSettingsExpander"
            Expanded="Expander_Expanded"
            Header="{DynamicResource plugin_explorer_generalsetting_header}"
            IsExpanded="False"
            Style="{StaticResource CustomExpanderStyle}">

            <!--  Margin="32 -10 0 0" is to make sure elements is left aligned to the text in the expander text  -->
            <Grid Margin="32 -10 0 0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <CheckBox
                    Grid.Row="0"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    HorizontalAlignment="Left"
                    Content="{DynamicResource plugin_explorer_use_location_as_working_dir}"
                    IsChecked="{Binding Settings.UseLocationAsWorkingDir}" />

                <CheckBox
                    Grid.Row="1"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    HorizontalAlignment="Left"
                    Content="{DynamicResource plugin_explorer_default_open_in_file_manager}"
                    IsChecked="{Binding Settings.DefaultOpenFolderInFileManager}" />

                <CheckBox
                    Grid.Row="2"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    HorizontalAlignment="Left"
                    Content="{DynamicResource plugin_explorer_display_more_info_in_tooltip}"
                    IsChecked="{Binding Settings.DisplayMoreInformationInToolTip}" />

                <TextBlock
                    Grid.Row="3"
                    Grid.Column="0"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"
                    Foreground="{DynamicResource Color05B}"
                    Text="{DynamicResource plugin_explorer_file_editor_path}" />
                <StackPanel
                    Grid.Row="3"
                    Grid.Column="1"
                    Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
                    Orientation="Horizontal">
                    <TextBox
                        Width="{StaticResource SettingPanelPathTextBoxWidth}"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        Text="{Binding FileEditorPath}"
                        TextWrapping="NoWrap" />
                    <Button
                        Margin="{StaticResource SettingPanelItemLeftMargin}"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        Command="{Binding OpenFileEditorPathCommand}"
                        Content="{DynamicResource select}" />
                </StackPanel>

                <TextBlock
                    Grid.Row="4"
                    Grid.Column="0"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"
                    Foreground="{DynamicResource Color05B}"
                    Text="{DynamicResource plugin_explorer_folder_editor_path}" />
                <StackPanel
                    Grid.Row="4"
                    Grid.Column="1"
                    Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
                    Orientation="Horizontal">
                    <TextBox
                        Width="{StaticResource SettingPanelPathTextBoxWidth}"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        Text="{Binding FolderEditorPath}"
                        TextWrapping="NoWrap" />
                    <Button
                        Margin="{StaticResource SettingPanelItemLeftMargin}"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        Command="{Binding OpenFolderEditorPathCommand}"
                        Content="{DynamicResource select}" />
                </StackPanel>

                <TextBlock
                    Grid.Row="5"
                    Grid.Column="0"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"
                    Foreground="{DynamicResource Color05B}"
                    Text="{DynamicResource plugin_explorer_shell_path}" />
                <StackPanel
                    Grid.Row="5"
                    Grid.Column="1"
                    Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
                    Orientation="Horizontal">
                    <TextBox
                        Width="{StaticResource SettingPanelPathTextBoxWidth}"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        Text="{Binding ShellPath}"
                        TextWrapping="NoWrap" />
                    <Button
                        Margin="{StaticResource SettingPanelItemLeftMargin}"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        Command="{Binding OpenShellPathCommand}"
                        Content="{DynamicResource select}" />
                </StackPanel>

                <TextBlock
                    Grid.Row="6"
                    Grid.Column="0"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    VerticalAlignment="Center"
                    Foreground="{DynamicResource Color05B}"
                    Text="{DynamicResource plugin_explorer_Index_Search_Engine}" />
                <ComboBox
                    Grid.Row="6"
                    Grid.Column="1"
                    Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"
                    DisplayMemberPath="Description"
                    ItemsSource="{Binding IndexSearchEngines}"
                    SelectedItem="{Binding SelectedIndexSearchEngine}" />

                <TextBlock
                    Grid.Row="7"
                    Grid.Column="0"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    VerticalAlignment="Center"
                    Foreground="{DynamicResource Color05B}"
                    Text="{DynamicResource plugin_explorer_Content_Search_Engine}" />
                <ComboBox
                    Grid.Row="7"
                    Grid.Column="1"
                    Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"
                    DisplayMemberPath="Description"
                    ItemsSource="{Binding ContentIndexSearchEngines}"
                    SelectedItem="{Binding SelectedContentSearchEngine}" />

                <TextBlock
                    Grid.Row="8"
                    Grid.Column="0"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    VerticalAlignment="Center"
                    Foreground="{DynamicResource Color05B}"
                    Text="{DynamicResource plugin_explorer_Directory_Recursive_Search_Engine}" />
                <ComboBox
                    Grid.Row="8"
                    Grid.Column="1"
                    Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"
                    DisplayMemberPath="Description"
                    ItemsSource="{Binding PathEnumerationEngines}"
                    SelectedItem="{Binding SelectedPathEnumerationEngine}" />

                <TextBlock
                    Grid.Row="9"
                    Grid.Column="0"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    VerticalAlignment="Center"
                    Foreground="{DynamicResource Color05B}"
                    Text="{DynamicResource plugin_explorer_Excluded_File_Types}" />
                <TextBox
                    Grid.Row="9"
                    Grid.Column="1"
                    MinWidth="{StaticResource SettingPanelTextBoxMinWidth}"
                    Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
                    HorizontalAlignment="Left"
                    Text="{Binding ExcludedFileTypes}"
                    ToolTip="{DynamicResource plugin_explorer_Excluded_File_Types_Tooltip}" />

                <TextBlock
                    Grid.Row="10"
                    Grid.Column="0"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    VerticalAlignment="Center"
                    Foreground="{DynamicResource Color05B}"
                    Text="{DynamicResource plugin_explorer_Maximum_Results}" />
                <TextBox
                    Grid.Row="10"
                    Grid.Column="1"
                    MinWidth="{StaticResource SettingPanelTextBoxMinWidth}"
                    Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"
                    MaxLength="6"
                    PreviewTextInput="AllowOnlyNumericInput"
                    Text="{Binding MaxResult}"
                    ToolTip="{DynamicResource plugin_explorer_Maximum_Results_Tooltip}" />

                <Button
                    Grid.Row="11"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    Click="btnOpenIndexingOptions_Click"
                    Content="{DynamicResource plugin_explorer_Open_Window_Index_Option}" />
            </Grid>
        </Expander>

        <!--  Native Context Menu Expander  -->
        <Expander
            x:Name="ContextMenuExpander"
            Expanded="Expander_Expanded"
            Header="{DynamicResource plugin_explorer_native_context_menu_header}"
            IsExpanded="False"
            Style="{StaticResource CustomExpanderStyle}">
            <Grid Margin="32 -10 0 0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <CheckBox
                    Grid.Row="0"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    Content="{DynamicResource plugin_explorer_native_context_menu_display_context_menu}"
                    IsChecked="{Binding ShowWindowsContextMenu}" />

                <TextBlock
                    Grid.Row="1"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    Foreground="{DynamicResource Color05B}"
                    Text="{DynamicResource plugin_explorer_native_context_menu_include_patterns_guide}"
                    TextWrapping="Wrap" />

                <TextBox
                    Grid.Row="2"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    MinHeight="{StaticResource SettingPanelAreaTextBoxMinHeight}"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    HorizontalAlignment="Stretch"
                    AcceptsReturn="True"
                    Text="{Binding WindowsContextMenuIncludedItems}"
                    TextWrapping="Wrap" />

                <TextBlock
                    Grid.Row="3"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    Foreground="{DynamicResource Color05B}"
                    Text="{DynamicResource plugin_explorer_native_context_menu_exclude_patterns_guide}"
                    TextWrapping="Wrap" />

                <TextBox
                    Grid.Row="4"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    MinHeight="{StaticResource SettingPanelAreaTextBoxMinHeight}"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    HorizontalAlignment="Stretch"
                    AcceptsReturn="True"
                    Text="{Binding WindowsContextMenuExcludedItems}"
                    TextWrapping="Wrap" />
            </Grid>
        </Expander>

        <!--  Preview Panel Settings Expander  -->
        <Expander
            x:Name="PreviewPanelExpander"
            Expanded="Expander_Expanded"
            Header="{DynamicResource plugin_explorer_previewpanel_setting_header}"
            IsExpanded="False"
            Style="{StaticResource CustomExpanderStyle}">
            <Grid Margin="32 -10 0 0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <DockPanel
                    Grid.Row="0"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    HorizontalAlignment="Stretch"
                    LastChildFill="True">
                    <TextBlock
                        Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                        VerticalAlignment="Center"
                        Foreground="{DynamicResource Color05B}"
                        Text="{DynamicResource plugin_explorer_previewpanel_file_info_label}" />
                    <WrapPanel
                        Width="Auto"
                        HorizontalAlignment="Right"
                        DockPanel.Dock="Right">
                        <CheckBox
                            Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
                            Content="{DynamicResource plugin_explorer_previewpanel_display_file_size_checkbox}"
                            IsChecked="{Binding ShowFileSizeInPreviewPanel}" />
                        <CheckBox
                            Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
                            Content="{DynamicResource plugin_explorer_previewpanel_display_file_creation_checkbox}"
                            IsChecked="{Binding ShowCreatedDateInPreviewPanel}" />
                        <CheckBox
                            Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
                            Content="{DynamicResource plugin_explorer_previewpanel_display_file_modification_checkbox}"
                            IsChecked="{Binding ShowModifiedDateInPreviewPanel}" />
                        <CheckBox
                            Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
                            Content="{DynamicResource plugin_explorer_previewpanel_display_file_age_checkbox}"
                            IsChecked="{Binding ShowFileAgeInPreviewPanel}" />
                    </WrapPanel>
                </DockPanel>

                <DockPanel
                    Grid.Row="1"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    HorizontalAlignment="Stretch"
                    LastChildFill="True">
                    <TextBlock
                        Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                        VerticalAlignment="Center"
                        Foreground="{DynamicResource Color05B}"
                        IsEnabled="{Binding ShowPreviewPanelDateTimeChoices}"
                        Text="{DynamicResource plugin_explorer_previewpanel_date_and_time_format_label}"
                        Visibility="{Binding PreviewPanelDateTimeChoicesVisibility}" />
                    <WrapPanel
                        Width="Auto"
                        HorizontalAlignment="Right"
                        DockPanel.Dock="Right"
                        IsEnabled="{Binding ShowPreviewPanelDateTimeChoices}"
                        Visibility="{Binding PreviewPanelDateTimeChoicesVisibility}">
                        <StackPanel Margin="{StaticResource SettingPanelItemTopBottomMargin}" Orientation="Horizontal">
                            <ComboBox
                                Margin="{StaticResource SettingPanelItemLeftMargin}"
                                ItemsSource="{Binding DateFormatList}"
                                SelectedItem="{Binding PreviewPanelDateFormat}" />
                            <TextBlock
                                Margin="{StaticResource SettingPanelItemLeftMargin}"
                                VerticalAlignment="Center"
                                Foreground="{DynamicResource Color05B}"
                                Text="{Binding PreviewPanelDateFormatDemo}" />
                        </StackPanel>
                        <StackPanel Margin="{StaticResource SettingPanelItemTopBottomMargin}" Orientation="Horizontal">
                            <ComboBox
                                Margin="{StaticResource SettingPanelItemLeftMargin}"
                                ItemsSource="{Binding TimeFormatList}"
                                SelectedItem="{Binding PreviewPanelTimeFormat}" />
                            <TextBlock
                                Margin="{StaticResource SettingPanelItemLeftMargin}"
                                VerticalAlignment="Center"
                                Foreground="{DynamicResource Color05B}"
                                Text="{Binding PreviewPanelTimeFormatDemo}" />
                        </StackPanel>
                    </WrapPanel>
                </DockPanel>
            </Grid>
        </Expander>

        <!--  Everything Settings Expander  -->
        <Expander
            x:Name="EverythingExpander"
            Expanded="Expander_Expanded"
            Header="{DynamicResource plugin_explorer_everything_setting_header}"
            IsExpanded="False"
            Style="{StaticResource CustomExpanderStyle}">
            <Grid Margin="32 -10 0 0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <CheckBox
                    Grid.Row="0"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    HorizontalAlignment="Left"
                    Content="{DynamicResource flowlauncher_plugin_everything_search_fullpath}"
                    IsChecked="{Binding Settings.EverythingSearchFullPath}" />

                <CheckBox
                    Grid.Row="1"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    HorizontalAlignment="Left"
                    Content="{DynamicResource flowlauncher_plugin_everything_enable_run_count}"
                    IsChecked="{Binding Settings.EverythingEnableRunCount}" />

                <TextBlock
                    Grid.Row="2"
                    Grid.Column="0"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    VerticalAlignment="Center"
                    Foreground="{DynamicResource Color05B}"
                    Text="{DynamicResource plugin_explorer_everything_sort_option}" />
                <ComboBox
                    Grid.Row="2"
                    Grid.Column="1"
                    Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
                    VerticalAlignment="Center"
                    ItemsSource="{Binding Settings.SortOptions, Mode=OneWay}"
                    SelectedItem="{Binding Settings.SortOption}"
                    SelectionChanged="EverythingSortOptionChanged">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <Grid>
                                <TextBlock Text="{Binding Converter={StaticResource EnumNameConverter}}" />
                            </Grid>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>

                <TextBlock
                    Grid.Row="3"
                    Grid.Column="0"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    VerticalAlignment="Center"
                    Foreground="{DynamicResource Color05B}"
                    Text="{DynamicResource plugin_explorer_everything_installed_path}" />
                <TextBox
                    Grid.Row="3"
                    Grid.Column="1"
                    Width="{StaticResource SettingPanelPathTextBoxWidth}"
                    Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
                    HorizontalAlignment="Left"
                    Text="{Binding EverythingInstalledPath}" />

                <TextBlock
                    Name="tbFastSortWarning"
                    Grid.Row="4"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    VerticalAlignment="Center"
                    Foreground="Orange"
                    Text="{Binding SortOptionWarningMessage, Mode=OneTime}"
                    TextAlignment="Left"
                    TextWrapping="Wrap"
                    Visibility="{Binding FastSortWarningVisibility, Mode=OneTime}" />
            </Grid>
        </Expander>

        <!--  Manage Action Keywords Expander  -->
        <Expander
            x:Name="ActionKeywordsExpander"
            Expanded="Expander_Expanded"
            Header="{DynamicResource plugin_explorer_manageactionkeywords_header}"
            IsExpanded="False"
            Style="{StaticResource CustomExpanderStyle}">
            <Grid Margin="32 -10 0 0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <Border
                    Grid.Row="0"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    HorizontalAlignment="Stretch"
                    BorderBrush="{DynamicResource PopupButtonAreaBorderColor}"
                    BorderThickness="1">
                    <ListView
                        ItemTemplate="{StaticResource ListViewActionKeywords}"
                        ItemsSource="{Binding ActionKeywordsModels}"
                        SelectedItem="{Binding SelectedActionKeyword}" />
                </Border>

                <StackPanel
                    Grid.Row="1"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    HorizontalAlignment="Right"
                    Orientation="Horizontal">
                    <Button
                        MinWidth="100"
                        Command="{Binding EditActionKeywordCommand}"
                        Content="{DynamicResource plugin_explorer_edit}" />
                </StackPanel>
            </Grid>
        </Expander>

        <!--  Quick Access Links Expander  -->
        <Expander
            x:Name="QuickAccessExpander"
            Expanded="Expander_Expanded"
            Header="{DynamicResource plugin_explorer_quickaccesslinks_header}"
            IsExpanded="False"
            Style="{StaticResource CustomExpanderStyle}">
            <Grid Margin="32 -10 0 0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <Border
                    Grid.Row="0"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    HorizontalAlignment="Stretch"
                    BorderBrush="{DynamicResource PopupButtonAreaBorderColor}"
                    BorderThickness="1">
                    <ListView
                        x:Name="lbxAccessLinks"
                        Height="200"
                        AllowDrop="True"
                        BorderThickness="1"
                        DragEnter="lbxAccessLinks_DragEnter"
                        Drop="LbxAccessLinks_OnDrop"
                        ItemsSource="{Binding Settings.QuickAccessLinks}"
                        Loaded="lbxAccessLinks_Loaded"
                        SelectedItem="{Binding SelectedQuickAccessLink}"
                        SizeChanged="lbxAccessLinks_SizeChanged">
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Width="600" Header="{DynamicResource plugin_explorer_name}">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Name}" />
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                                <GridViewColumn Width="900" Header="{DynamicResource plugin_explorer_path}">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Path}" TextTrimming="CharacterEllipsis" />
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                            </GridView>
                        </ListView.View>
                    </ListView>
                </Border>

                <StackPanel
                    Grid.Row="1"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    HorizontalAlignment="Right"
                    Orientation="Horizontal">
                    <Button
                        MinWidth="100"
                        Command="{Binding RemoveLinkCommand}"
                        CommandParameter="QuickAccessLink"
                        Content="{DynamicResource plugin_explorer_delete}" />
                    <Button
                        MinWidth="100"
                        Margin="{StaticResource SettingPanelItemLeftMargin}"
                        Command="{Binding EditQuickAccessLinkCommand}"
                        Content="{DynamicResource plugin_explorer_edit}" />
                    <Button
                        MinWidth="100"
                        Margin="{StaticResource SettingPanelItemLeftMargin}"
                        Command="{Binding AddQuickAccessLinkCommand}"
                        Content="{DynamicResource plugin_explorer_add}" />
                </StackPanel>
            </Grid>
        </Expander>

        <!--  Index Search Excluded Paths Expander  -->
        <Expander
            x:Name="ExcludedPathsExpander"
            Margin="0"
            BorderThickness="0 0 0 0"
            Expanded="Expander_Expanded"
            Header="{DynamicResource plugin_explorer_indexsearchexcludedpaths_header}"
            IsExpanded="False"
            Style="{StaticResource CustomExpanderStyle}">
            <Grid Margin="32 -10 0 0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <Border
                    Grid.Row="0"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    HorizontalAlignment="Stretch"
                    BorderBrush="{DynamicResource PopupButtonAreaBorderColor}"
                    BorderThickness="1">
                    <ListView
                        Name="lbxExcludedPaths"
                        Height="200"
                        AllowDrop="True"
                        DragEnter="lbxAccessLinks_DragEnter"
                        Drop="LbxExcludedPaths_OnDrop"
                        ItemTemplate="{StaticResource ListViewTemplateAccessLinks}"
                        ItemsSource="{Binding Settings.IndexSearchExcludedSubdirectoryPaths}"
                        Loaded="lbxExcludedPaths_Loaded"
                        SelectedItem="{Binding SelectedIndexSearchExcludedPath}" />
                </Border>

                <StackPanel
                    Grid.Row="1"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                    HorizontalAlignment="Right"
                    Orientation="Horizontal">
                    <Button
                        MinWidth="100"
                        Command="{Binding RemoveLinkCommand}"
                        CommandParameter="IndexSearchExcludedPaths"
                        Content="{DynamicResource plugin_explorer_delete}" />
                    <Button
                        MinWidth="100"
                        Margin="{StaticResource SettingPanelItemLeftMargin}"
                        Command="{Binding EditIndexSearchExcludePathsCommand}"
                        Content="{DynamicResource plugin_explorer_edit}" />
                    <Button
                        MinWidth="100"
                        Margin="{StaticResource SettingPanelItemLeftMargin}"
                        Command="{Binding AddIndexSearchExcludePathsCommand}"
                        Content="{DynamicResource plugin_explorer_add}" />
                </StackPanel>
            </Grid>
        </Expander>
    </StackPanel>
</UserControl>