<UserControl
    x:Class="Flow.Launcher.Plugin.Explorer.Views.ExplorerSettings"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:Flow.Launcher.Plugin.Explorer.Views.Converters"
    xmlns:core="clr-namespace:Flow.Launcher.Core.Resource;assembly=Flow.Launcher.Core"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:qa="clr-namespace:Flow.Launcher.Plugin.Explorer.Search.QuickAccessLinks"
    xmlns:ui="http://schemas.modernwpf.com/2019"
    xmlns:viewModels="clr-namespace:Flow.Launcher.Plugin.Explorer.ViewModels"
    xmlns:views="clr-namespace:Flow.Launcher.Plugin.Explorer.Views"
    d:DataContext="{d:DesignInstance viewModels:SettingsViewModel}"
    d:DesignHeight="450"
    d:DesignWidth="800"
    mc:Ignorable="d">

    <UserControl.Resources>
        <Style x:Key="HeaderTextBlockStyle" TargetType="TextBlock">
            <Setter Property="HorizontalAlignment" Value="Left" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="Margin" Value="{StaticResource SettingPanelItemTopBottomMargin}" />
            <Setter Property="TextAlignment" Value="Left" />
            <Setter Property="TextWrapping" Value="Wrap" />
            <Setter Property="FontWeight" Value="Bold" />
        </Style>

        <DataTemplate x:Key="ListViewTemplateAccessLinks" DataType="qa:AccessLink">
            <TextBlock Margin="0 5 0 5" Text="{Binding Path, Mode=OneTime}" />
        </DataTemplate>

        <core:TranslationConverter x:Key="TranslationConverter" />
        <DataTemplate x:Key="ListViewActionKeywords" DataType="{x:Type views:ActionKeywordModel}">
            <Grid>
                <TextBlock
                    Margin="0 5 0 0"
                    IsEnabled="{Binding Enabled}"
                    Text="{Binding Description, Mode=OneTime, Converter={StaticResource TranslationConverter}}">
                    <TextBlock.Style>
                        <Style TargetType="{x:Type TextBlock}">
                            <Style.Triggers>
                                <Trigger Property="IsEnabled" Value="True">
                                    <Setter Property="Foreground" Value="{DynamicResource Color05B}" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter Property="Foreground" Value="{DynamicResource Color18B}" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>

                <TextBlock
                    Margin="250 5 0 0"
                    IsEnabled="{Binding Enabled}"
                    Text="{Binding Keyword}">
                    <TextBlock.Style>
                        <Style TargetType="{x:Type TextBlock}">
                            <Style.Triggers>
                                <Trigger Property="IsEnabled" Value="True">
                                    <Setter Property="Foreground" Value="{DynamicResource Color05B}" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter Property="Foreground" Value="{DynamicResource Color18B}" />
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>

                <TextBlock Margin="480 5 0 0">
                    <TextBlock.Style>
                        <Style TargetType="{x:Type TextBlock}">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Enabled}" Value="True">
                                    <Setter Property="Text" Value="{DynamicResource plugin_explorer_enabled}" />
                                    <Setter Property="Foreground" Value="{DynamicResource Color05B}" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Enabled}" Value="False">
                                    <Setter Property="Text" Value="{DynamicResource plugin_explorer_disabled}" />
                                    <Setter Property="Foreground" Value="{DynamicResource Color18B}" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>
            </Grid>
        </DataTemplate>

        <converters:EnumNameConverter x:Key="EnumNameConverter" />
    </UserControl.Resources>

    <Grid Margin="{StaticResource SettingPanelMargin}">
        <Grid.RowDefinitions>
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!--  General Setting  -->
        <TextBlock
            Grid.Row="0"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Style="{StaticResource HeaderTextBlockStyle}"
            Text="{DynamicResource plugin_explorer_generalsetting_header}" />

        <CheckBox
            Grid.Row="1"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            HorizontalAlignment="Left"
            Content="{DynamicResource plugin_explorer_use_location_as_working_dir}"
            IsChecked="{Binding Settings.UseLocationAsWorkingDir}" />

        <CheckBox
            Grid.Row="2"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            HorizontalAlignment="Left"
            Content="{DynamicResource plugin_explorer_default_open_in_file_manager}"
            IsChecked="{Binding Settings.DefaultOpenFolderInFileManager}" />

        <TextBlock
            Grid.Row="3"
            Grid.Column="0"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            HorizontalAlignment="Left"
            VerticalAlignment="Center"
            Text="{DynamicResource plugin_explorer_file_editor_path}" />
        <StackPanel
            Grid.Row="3"
            Grid.Column="1"
            Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
            Orientation="Horizontal">
            <TextBox
                MinWidth="180"
                HorizontalAlignment="Left"
                VerticalAlignment="Center"
                Text="{Binding FileEditorPath}"
                TextWrapping="NoWrap" />
            <Button
                MinWidth="45"
                Margin="{StaticResource SettingPanelItemLeftMargin}"
                HorizontalAlignment="Left"
                VerticalAlignment="Center"
                Command="{Binding OpenFileEditorPath}"
                Content="..." />
        </StackPanel>

        <TextBlock
            Grid.Row="4"
            Grid.Column="0"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            HorizontalAlignment="Left"
            VerticalAlignment="Center"
            Text="{DynamicResource plugin_explorer_folder_editor_path}" />
        <StackPanel
            Grid.Row="4"
            Grid.Column="1"
            Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
            Orientation="Horizontal">
            <TextBox
                MinWidth="180"
                HorizontalAlignment="Left"
                VerticalAlignment="Center"
                Text="{Binding FolderEditorPath}"
                TextWrapping="NoWrap" />
            <Button
                MinWidth="45"
                Margin="{StaticResource SettingPanelItemLeftMargin}"
                HorizontalAlignment="Left"
                VerticalAlignment="Center"
                Command="{Binding OpenFolderEditorPath}"
                Content="..." />
        </StackPanel>

        <TextBlock
            Grid.Row="5"
            Grid.Column="0"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            HorizontalAlignment="Left"
            VerticalAlignment="Center"
            Text="{DynamicResource plugin_explorer_shell_path}" />
        <StackPanel
            Grid.Row="5"
            Grid.Column="1"
            Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
            Orientation="Horizontal">
            <TextBox
                MinWidth="180"
                HorizontalAlignment="Left"
                VerticalAlignment="Center"
                Text="{Binding ShellPath}"
                TextWrapping="NoWrap" />
            <Button
                MinWidth="45"
                Margin="{StaticResource SettingPanelItemLeftMargin}"
                HorizontalAlignment="Left"
                VerticalAlignment="Center"
                Command="{Binding OpenShellPath}"
                Content="..." />
        </StackPanel>

        <TextBlock
            Grid.Row="6"
            Grid.Column="0"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            VerticalAlignment="Center"
            Text="{DynamicResource plugin_explorer_Index_Search_Engine}" />
        <ComboBox
            Grid.Row="6"
            Grid.Column="1"
            Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
            HorizontalAlignment="Left"
            VerticalAlignment="Center"
            DisplayMemberPath="Description"
            ItemsSource="{Binding IndexSearchEngines}"
            SelectedItem="{Binding SelectedIndexSearchEngine}" />

        <TextBlock
            Grid.Row="7"
            Grid.Column="0"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            VerticalAlignment="Center"
            Text="{DynamicResource plugin_explorer_Content_Search_Engine}" />
        <ComboBox
            Grid.Row="7"
            Grid.Column="1"
            Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
            HorizontalAlignment="Left"
            VerticalAlignment="Center"
            DisplayMemberPath="Description"
            ItemsSource="{Binding ContentIndexSearchEngines}"
            SelectedItem="{Binding SelectedContentSearchEngine}" />

        <TextBlock
            Grid.Row="8"
            Grid.Column="0"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            VerticalAlignment="Center"
            Text="{DynamicResource plugin_explorer_Directory_Recursive_Search_Engine}" />
        <ComboBox
            Grid.Row="8"
            Grid.Column="1"
            Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
            HorizontalAlignment="Left"
            VerticalAlignment="Center"
            DisplayMemberPath="Description"
            ItemsSource="{Binding PathEnumerationEngines}"
            SelectedItem="{Binding SelectedPathEnumerationEngine}" />

        <TextBlock
            Grid.Row="9"
            Grid.Column="0"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            VerticalAlignment="Center"
            Text="{DynamicResource plugin_explorer_Excluded_File_Types}" />
        <TextBox
            Grid.Row="9"
            Grid.Column="1"
            MinWidth="180"
            Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
            HorizontalAlignment="Left"
            Text="{Binding ExcludedFileTypes}"
            ToolTip="{DynamicResource plugin_explorer_Excluded_File_Types_Tooltip}" />

        <TextBlock
            Grid.Row="10"
            Grid.Column="0"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            VerticalAlignment="Center"
            Text="{DynamicResource plugin_explorer_Maximum_Results}" />
        <TextBox
            Grid.Row="10"
            Grid.Column="1"
            MinWidth="180"
            Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
            HorizontalAlignment="Left"
            VerticalAlignment="Center"
            MaxLength="6"
            PreviewTextInput="AllowOnlyNumericInput"
            Text="{Binding MaxResult}"
            ToolTip="{DynamicResource plugin_explorer_Maximum_Results_Tooltip}" />

        <Button
            Grid.Row="11"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            Click="btnOpenIndexingOptions_Click"
            Content="{DynamicResource plugin_explorer_Open_Window_Index_Option}" />

        <!--  Native Context Menu  -->
        <StackPanel
            Grid.Row="12"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Orientation="Vertical">
            <Separator Style="{StaticResource SettingPanelSeperatorStyle}" />
            <TextBlock Style="{StaticResource HeaderTextBlockStyle}" Text="{DynamicResource plugin_explorer_native_context_menu_header}" />
        </StackPanel>

        <CheckBox
            Grid.Row="13"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            Content="{DynamicResource plugin_explorer_native_context_menu_display_context_menu}"
            IsChecked="{Binding ShowWindowsContextMenu}" />

        <TextBlock
            Grid.Row="14"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            Text="{DynamicResource plugin_explorer_native_context_menu_include_patterns_guide}"
            TextWrapping="Wrap" />

        <TextBox
            Grid.Row="15"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            MinWidth="180"
            MaxHeight="150"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            HorizontalAlignment="Left"
            AcceptsReturn="True"
            Text="{Binding WindowsContextMenuIncludedItems}"
            TextWrapping="Wrap" />

        <TextBlock
            Grid.Row="16"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            Text="{DynamicResource plugin_explorer_native_context_menu_exclude_patterns_guide}"
            TextWrapping="Wrap" />

        <TextBox
            Grid.Row="17"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            MinWidth="180"
            MaxHeight="150"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            HorizontalAlignment="Left"
            AcceptsReturn="True"
            Text="{Binding WindowsContextMenuExcludedItems}"
            TextWrapping="Wrap" />

        <!--  Preview Panel  -->
        <StackPanel
            Grid.Row="18"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Orientation="Vertical">
            <Separator Style="{StaticResource SettingPanelSeperatorStyle}" />
            <TextBlock Style="{StaticResource HeaderTextBlockStyle}" Text="{DynamicResource plugin_explorer_previewpanel_setting_header}" />
        </StackPanel>

        <DockPanel
            Grid.Row="19"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            HorizontalAlignment="Stretch"
            LastChildFill="True">
            <TextBlock
                Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                VerticalAlignment="Center"
                Text="{DynamicResource plugin_explorer_previewpanel_file_info_label}" />
            <WrapPanel
                Width="Auto"
                HorizontalAlignment="Right"
                DockPanel.Dock="Right">
                <CheckBox
                    Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
                    Content="{DynamicResource plugin_explorer_previewpanel_display_file_size_checkbox}"
                    IsChecked="{Binding ShowFileSizeInPreviewPanel}" />
                <CheckBox
                    Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
                    Content="{DynamicResource plugin_explorer_previewpanel_display_file_creation_checkbox}"
                    IsChecked="{Binding ShowCreatedDateInPreviewPanel}" />
                <CheckBox
                    Margin="{StaticResource SettingPanelItemLeftTopBottomMargin}"
                    Content="{DynamicResource plugin_explorer_previewpanel_display_file_modification_checkbox}"
                    IsChecked="{Binding ShowModifiedDateInPreviewPanel}" />
            </WrapPanel>
        </DockPanel>

        <DockPanel
            Grid.Row="20"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            HorizontalAlignment="Stretch"
            LastChildFill="True">
            <TextBlock
                Margin="{StaticResource SettingPanelItemTopBottomMargin}"
                VerticalAlignment="Center"
                IsEnabled="{Binding ShowPreviewPanelDateTimeChoices}"
                Text="{DynamicResource plugin_explorer_previewpanel_date_and_time_format_label}"
                Visibility="{Binding PreviewPanelDateTimeChoicesVisibility}" />
            <WrapPanel
                Width="Auto"
                HorizontalAlignment="Right"
                DockPanel.Dock="Right"
                IsEnabled="{Binding ShowPreviewPanelDateTimeChoices}"
                Visibility="{Binding PreviewPanelDateTimeChoicesVisibility}">
                <StackPanel Margin="{StaticResource SettingPanelItemTopBottomMargin}" Orientation="Horizontal">
                    <ComboBox
                        Margin="{StaticResource SettingPanelItemLeftMargin}"
                        ItemsSource="{Binding DateFormatList}"
                        SelectedItem="{Binding PreviewPanelDateFormat}" />
                    <TextBlock
                        Margin="{StaticResource SettingPanelItemLeftMargin}"
                        VerticalAlignment="Center"
                        Text="{Binding PreviewPanelDateFormatDemo}" />
                </StackPanel>
                <StackPanel Margin="{StaticResource SettingPanelItemTopBottomMargin}" Orientation="Horizontal">
                    <ComboBox
                        Margin="{StaticResource SettingPanelItemLeftMargin}"
                        ItemsSource="{Binding TimeFormatList}"
                        SelectedItem="{Binding PreviewPanelTimeFormat}" />
                    <TextBlock
                        Margin="{StaticResource SettingPanelItemLeftMargin}"
                        VerticalAlignment="Center"
                        Text="{Binding PreviewPanelTimeFormatDemo}" />
                </StackPanel>
            </WrapPanel>
        </DockPanel>

        <!--  Everything Setting  -->
        <StackPanel
            Grid.Row="21"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Orientation="Vertical">
            <Separator Style="{StaticResource SettingPanelSeperatorStyle}" />
            <TextBlock Style="{StaticResource HeaderTextBlockStyle}" Text="{DynamicResource plugin_explorer_everything_setting_header}" />
        </StackPanel>

        <CheckBox
            Grid.Row="22"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            HorizontalAlignment="Left"
            Content="{DynamicResource flowlauncher_plugin_everything_search_fullpath}"
            IsChecked="{Binding Settings.EverythingSearchFullPath}" />

        <CheckBox
            Grid.Row="23"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            HorizontalAlignment="Left"
            Content="{DynamicResource flowlauncher_plugin_everything_enable_run_count}"
            IsChecked="{Binding Settings.EverythingEnableRunCount}" />

        <TextBlock
            Grid.Row="24"
            Grid.Column="0"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            VerticalAlignment="Center"
            Text="{DynamicResource plugin_explorer_everything_sort_option}" />
        <ComboBox
            Grid.Row="24"
            Grid.Column="1"
            Margin="{StaticResource SettingPanelItemRightTopBottomMargin}"
            VerticalAlignment="Center"
            ItemsSource="{Binding Settings.SortOptions, Mode=OneWay}"
            SelectedItem="{Binding Settings.SortOption}"
            SelectionChanged="EverythingSortOptionChanged">
            <ComboBox.ItemTemplate>
                <DataTemplate>
                    <Grid>
                        <TextBlock Text="{Binding Converter={StaticResource EnumNameConverter}}" />
                    </Grid>
                </DataTemplate>
            </ComboBox.ItemTemplate>
        </ComboBox>

        <TextBlock
            Grid.Row="26"
            Grid.Column="0"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            VerticalAlignment="Center"
            Text="{DynamicResource plugin_explorer_everything_installed_path}" />
        <TextBox
            Grid.Row="26"
            Grid.Column="1"
            MinWidth="240"
            Margin="{StaticResource SettingPanelItemRightTopBottomMargin}"
            HorizontalAlignment="Left"
            Text="{Binding EverythingInstalledPath}" />

        <TextBlock
            Name="tbFastSortWarning"
            Grid.Row="27"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            VerticalAlignment="Center"
            Foreground="Orange"
            Text="{Binding SortOptionWarningMessage, Mode=OneTime}"
            TextAlignment="Left"
            TextWrapping="Wrap"
            Visibility="{Binding FastSortWarningVisibility, Mode=OneTime}" />

        <!--  Customise Action Keywords  -->
        <StackPanel
            Grid.Row="28"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Orientation="Vertical">
            <Separator Style="{StaticResource SettingPanelSeperatorStyle}" />
            <TextBlock Style="{StaticResource HeaderTextBlockStyle}" Text="{DynamicResource plugin_explorer_manageactionkeywords_header}" />
        </StackPanel>

        <Border
            Grid.Row="29"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            HorizontalAlignment="Stretch"
            BorderBrush="{DynamicResource PopupButtonAreaBorderColor}"
            BorderThickness="1">
            <ListView
                ItemTemplate="{StaticResource ListViewActionKeywords}"
                ItemsSource="{Binding ActionKeywordsModels}"
                SelectedItem="{Binding SelectedActionKeyword}" />
        </Border>

        <StackPanel
            Grid.Row="30"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            HorizontalAlignment="Right"
            Orientation="Horizontal">
            <Button
                MinWidth="100"
                Command="{Binding EditActionKeywordCommand}"
                Content="{DynamicResource plugin_explorer_edit}" />
        </StackPanel>

        <!--  Quick Access Links  -->
        <StackPanel
            Grid.Row="31"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Orientation="Vertical">
            <Separator Style="{StaticResource SettingPanelSeperatorStyle}" />
            <TextBlock Style="{StaticResource HeaderTextBlockStyle}" Text="{DynamicResource plugin_explorer_quickaccesslinks_header}" />
        </StackPanel>

        <Border
            Grid.Row="32"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            HorizontalAlignment="Stretch"
            BorderBrush="{DynamicResource PopupButtonAreaBorderColor}"
            BorderThickness="1">
            <ListView
                x:Name="lbxAccessLinks"
                Height="200"
                AllowDrop="True"
                BorderThickness="1"
                DragEnter="lbxAccessLinks_DragEnter"
                Drop="LbxAccessLinks_OnDrop"
                ItemTemplate="{StaticResource ListViewTemplateAccessLinks}"
                ItemsSource="{Binding Settings.QuickAccessLinks}"
                SelectedItem="{Binding SelectedQuickAccessLink}" />
        </Border>

        <StackPanel
            Grid.Row="33"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            HorizontalAlignment="Right"
            Orientation="Horizontal">
            <Button
                MinWidth="100"
                Command="{Binding RemoveLinkCommand}"
                CommandParameter="QuickAccessLink"
                Content="{DynamicResource plugin_explorer_delete}" />
            <Button
                MinWidth="100"
                Margin="{StaticResource SettingPanelItemLeftMargin}"
                Command="{Binding EditLinkCommand}"
                CommandParameter="QuickAccessLink"
                Content="{DynamicResource plugin_explorer_edit}" />
            <Button
                MinWidth="100"
                Margin="{StaticResource SettingPanelItemLeftMargin}"
                Command="{Binding AddLinkCommand}"
                CommandParameter="QuickAccessLink"
                Content="{DynamicResource plugin_explorer_add}" />
        </StackPanel>

        <!--  Index Search Excluded Paths  -->
        <StackPanel
            Grid.Row="34"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Orientation="Vertical">
            <Separator Style="{StaticResource SettingPanelSeperatorStyle}" />
            <TextBlock Style="{StaticResource HeaderTextBlockStyle}" Text="{DynamicResource plugin_explorer_indexsearchexcludedpaths_header}" />
        </StackPanel>

        <Border
            Grid.Row="35"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            HorizontalAlignment="Stretch"
            BorderBrush="{DynamicResource PopupButtonAreaBorderColor}"
            BorderThickness="1">
            <ListView
                Name="lbxExcludedPaths"
                Height="200"
                AllowDrop="True"
                DragEnter="lbxAccessLinks_DragEnter"
                Drop="LbxExcludedPaths_OnDrop"
                ItemTemplate="{StaticResource ListViewTemplateAccessLinks}"
                ItemsSource="{Binding Settings.IndexSearchExcludedSubdirectoryPaths}"
                SelectedItem="{Binding SelectedIndexSearchExcludedPath}" />
        </Border>

        <StackPanel
            Grid.Row="36"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Margin="{StaticResource SettingPanelItemTopBottomMargin}"
            HorizontalAlignment="Right"
            Orientation="Horizontal">
            <Button
                MinWidth="100"
                Command="{Binding RemoveLinkCommand}"
                CommandParameter="IndexSearchExcludedPaths"
                Content="{DynamicResource plugin_explorer_delete}" />
            <Button
                MinWidth="100"
                Margin="{StaticResource SettingPanelItemLeftMargin}"
                Command="{Binding EditLinkCommand}"
                CommandParameter="IndexSearchExcludedPaths"
                Content="{DynamicResource plugin_explorer_edit}" />
            <Button
                MinWidth="100"
                Margin="{StaticResource SettingPanelItemLeftMargin}"
                Command="{Binding AddLinkCommand}"
                CommandParameter="IndexSearchExcludedPaths"
                Content="{DynamicResource plugin_explorer_add}" />
        </StackPanel>

    </Grid>

</UserControl>
