<ui:Page
    x:Class="Flow.Launcher.SettingPages.Views.SettingsPanePlugins"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    xmlns:ui="http://schemas.modernwpf.com/2019"
    xmlns:converters="clr-namespace:Flow.Launcher.Converters"
    xmlns:viewModels="clr-namespace:Flow.Launcher.SettingPages.ViewModels"
    xmlns:cc="clr-namespace:Flow.Launcher.Resources.Controls"
    Title="Plugins"
    FocusManager.FocusedElement="{Binding ElementName=PluginFilterTextbox}"
    KeyDown="SettingsPanePlugins_OnKeyDown"
    d:DataContext="{d:DesignInstance viewModels:SettingsPanePluginsViewModel}"
    d:DesignHeight="450"
    d:DesignWidth="800"
    mc:Ignorable="d">
    <ui:Page.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
        <converters:StringEqualityToVisibilityConverter x:Key="StringEqualityToVisibilityConverter" />
    </ui:Page.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="73" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <DockPanel Grid.Row="0" Margin="5 18 0 0">
            <TextBlock
                Margin="0 5 0 0"
                DockPanel.Dock="Left"
                FontSize="30"
                Style="{StaticResource PageTitle}"
                Text="{DynamicResource plugins}"
                TextAlignment="Left" />
            <StackPanel
                DockPanel.Dock="Right"
                Orientation="Horizontal"
                HorizontalAlignment="Right"
                VerticalAlignment="Center">
                <RadioButton
                    x:Name="OnOffToggle"
                    Content="OnOff"
                    Height="34"
                    Margin="0 0 8 0"
                    IsChecked="{Binding IsOnOffSelected, Mode=TwoWay}"
                    GroupName="PluginToggleGroup"
                    Style="{StaticResource {x:Type ToggleButton}}" />
                <RadioButton
                    x:Name="PriorityToggle"
                    Content="Priority"
                    Height="34"
                    Margin="0 0 8 0"
                    IsChecked="{Binding IsPrioritySelected, Mode=TwoWay}"
                    GroupName="PluginToggleGroup"
                    Style="{StaticResource {x:Type ToggleButton}}" />
                <RadioButton
                    x:Name="SearchDelayToggle"
                    Content="Search Delay"
                    Height="34"
                    Margin="0 0 8 0"
                    IsChecked="{Binding IsSearchDelaySelected, Mode=TwoWay}"
                    GroupName="PluginToggleGroup"
                    Style="{StaticResource {x:Type ToggleButton}}" />
                <TextBox
                    Name="PluginFilterTextbox"
                    Width="150"
                    Height="34"
                    Margin="0 0 26 0"
                    ContextMenu="{StaticResource TextBoxContextMenu}"
                    FontSize="14"
                    Text="{Binding FilterText, UpdateSourceTrigger=PropertyChanged}"
                    TextAlignment="Left"
                    ToolTip="{DynamicResource searchpluginToolTip}"
                    ToolTipService.InitialShowDelay="200"
                    ToolTipService.Placement="Top">
                </TextBox>
            </StackPanel>
        </DockPanel>
        
        <Border Grid.Row="1" Grid.Column="0" Background="{DynamicResource Color01B}">
            <ListBox
                Margin="5 0 7 10"
                Background="{DynamicResource Color01B}"
                FontSize="14"
                ItemsSource="{Binding FilteredPluginViewModels}"
                ItemContainerStyle="{StaticResource PluginList}"
                ScrollViewer.CanContentScroll="False"
                ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                SelectedItem="{Binding SelectedPlugin}"
                SnapsToDevicePixels="True"
                Style="{DynamicResource PluginListStyle}"
                VirtualizingPanel.ScrollUnit="Pixel"
                VirtualizingStackPanel.IsVirtualizing="True"
                VirtualizingStackPanel.VirtualizationMode="Recycling">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <cc:InstalledPluginDisplay />
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </Border>
    </Grid>
</ui:Page>
